/*
 * File: app/view/Feedback.js
 *
 * This file was generated by Sencha Architect
 * http://www.sencha.com/products/architect/
 *
 * This file requires use of the Sencha Touch 2.4.x library, under independent license.
 * License of Sencha Architect does not include license for Sencha Touch 2.4.x. For more
 * details see http://www.sencha.com/license or contact license@sencha.com.
 *
 * This file will be auto-generated each and everytime you save your project.
 *
 * Do NOT hand edit this file.
 */

Ext.define('ProDooMobileApp.view.Feedback', {
    extend: 'Ext.Container',

    requires: [
        'Ext.Label',
        'Ext.form.Panel',
        'Ext.field.TextArea',
        'Ext.dataview.List',
        'Ext.XTemplate',
        'Ext.Img',
        'Ext.Button'
    ],

    config: {
        itemId: 'FeedbackView',
        scrollable: true,
        cls: [
            'settingCnt',
            'scrollPadding'
        ],
        items: [
            {
                xtype: 'container',
                hidden: true,
                itemId: 'FeedbackSubmit',
                items: [
                    {
                        xtype: 'label',
                        cls: [
                            'SearchLabel',
                            'bgLightGreen'
                        ],
                        hidden: false,
                        html: 'Submit Feedback',
                        itemId: 'buttonsLabel',
                        margin: 0
                    },
                    {
                        xtype: 'formpanel',
                        cls: 'feedbackForm',
                        itemId: 'FeedbackSubmitForm',
                        items: [
                            {
                                xtype: 'textfield',
                                cls: [
                                    'inputCls',
                                    'bbBlack'
                                ],
                                itemId: 'FeedbackTitle',
                                clearIcon: false,
                                labelCls: 'labelCls',
                                name: 'Title',
                                maxLength: 50,
                                placeHolder: 'Title'
                            },
                            {
                                xtype: 'textareafield',
                                cls: 'FeedbackArea',
                                height: 300,
                                itemId: 'FeedbackDetail',
                                minHeight: 300,
                                clearIcon: false,
                                name: 'Content',
                                placeHolder: 'Detail',
                                listeners: [
                                    {
                                        fn: function(component, eOpts) {


                                            component.on('keyup', function (textarea) {
                                                G.get('FeedbackView').adjustHeight(textarea);
                                            });

                                            component.on('change', function (textarea, newValue) {
                                                G.get('FeedbackView').adjustHeight(textarea);
                                            });
                                        },
                                        event: 'initialize'
                                    }
                                ]
                            },
                            {
                                xtype: 'textfield',
                                hidden: true,
                                label: 'Field',
                                name: 'UserId'
                            },
                            {
                                xtype: 'textfield',
                                hidden: true,
                                label: 'Field',
                                name: 'FeedbackId'
                            }
                        ]
                    }
                ]
            },
            {
                xtype: 'list',
                cls: 'requestList',
                itemId: 'FeedbackList',
                width: '100%',
                modal: false,
                itemTpl: [
                    '<div class="requestCnt feedbackList">',
                    '    ',
                    '    <span class="savName">{Title}</span>',
                    '    <span class="closeIcon">',
                    '        <span class="x-button-label closeBtn"> </span>',
                    '    </span>',
                    '</div>'
                ],
                pressedCls: null,
                selectedCls: null,
                store: 'FeedbackStore'
            },
            {
                xtype: 'container',
                centered: true,
                cls: [
                    'labelCls',
                    'center'
                ],
                docked: 'top',
                hidden: true,
                html: '<br>Write your feedback<br> and will do better',
                itemId: 'FeedbackSplash',
                items: [
                    {
                        xtype: 'image',
                        height: 127,
                        margin: 'auto',
                        width: 152,
                        src: 'resources/images/splash/feedback.png'
                    }
                ]
            },
            {
                xtype: 'button',
                bottom: 10,
                cls: [
                    'homeIcon',
                    'btnCircle',
                    'bgLightGreen'
                ],
                docked: 'bottom',
                itemId: 'FeedbackHomeButton',
                left: 10,
                text: ' '
            },
            {
                xtype: 'button',
                bottom: 10,
                cls: [
                    'addBtn',
                    'bgLightGreen'
                ],
                docked: 'bottom',
                itemId: 'FeedbackAdd',
                right: 10,
                text: ' '
            },
            {
                xtype: 'button',
                cls: [
                    'backIcon',
                    'btnCircle',
                    'l10',
                    'b10',
                    'bgLightGreen'
                ],
                docked: 'bottom',
                hidden: true,
                itemId: 'FeedbackBack',
                text: ' '
            },
            {
                xtype: 'button',
                cls: [
                    'confirmIcon',
                    'btnCircle',
                    'bgLightGreen'
                ],
                docked: 'bottom',
                hidden: true,
                itemId: 'FeedbackSubmitBtn',
                text: ' '
            }
        ],
        listeners: [
            {
                fn: 'onListItemTap',
                event: 'itemtap',
                delegate: '#FeedbackList'
            },
            {
                fn: 'onFeedbackHomeBtnTap',
                event: 'tap',
                delegate: '#FeedbackHomeButton'
            },
            {
                fn: 'onFeedbackAddTap',
                event: 'tap',
                delegate: '#FeedbackAdd'
            },
            {
                fn: 'onFeedbackBackBtnTap',
                event: 'tap',
                delegate: '#FeedbackBack'
            }
        ]
    },

    onListItemTap: function(dataview, index, target, record, e, eOpts) {
        //SaveSearch.onSavedSearchResumeItemClick(dataview, index, target, record, e, eOpts);
    },

    onFeedbackHomeBtnTap: function(button, e, eOpts) {
        G.showHomeView();
    },

    onFeedbackAddTap: function(button, e, eOpts) {
        // Manage views
        G.show('FeedbackSubmit');
        G.get('buttonsLabel').setHtml('Submit Feedback');
        var form  = G.get('FeedbackSubmitForm');
        form.reset();
        G.hide('FeedbackList');
        G.hide('FeedbackSplash');

        //Manage Buttons
        G.show('FeedbackSubmitBtn');
        G.show('FeedbackBack');
        G.hide('FeedbackHomeButton');
        G.hide('FeedbackAdd');

        //Reset Form
        var form = G.get('FeedbackSubmitForm');
        form.reset();
        form.getFields().Title.setReadOnly(false);
        form.getFields().Content.setReadOnly(false);

    },

    onFeedbackBackBtnTap: function(button, e, eOpts) {
        G.hide('FeedbackSubmit');
        G.show('FeedbackList');

        G.hide('FeedbackSubmitBtn');
        G.hide('FeedbackBack');
        G.show('FeedbackHomeButton');
        G.show('FeedbackAdd');
        var store=Ext.getStore("FeedbackStore");
        store.load({
            callback : function() {
                if(Ext.getStore('FeedbackStore').data.items.length<=0){
                    G.show('FeedbackSplash');
                    G.get('FeedbackSplash').setHtml(Identifier.Title.Splash_Feedback);
                    G.hide('FeedbackList');
                }
            }
        });

    },

    adjustHeight: function(textarea) {
        var textAreaEl = textarea.getComponent().input;
            if (textAreaEl) {
                textAreaEl.dom.style.height = 'auto';
                textAreaEl.dom.style.height = textAreaEl.dom.scrollHeight + "px";
            }
    }

});