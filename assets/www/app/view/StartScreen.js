/*
 * File: app/view/StartScreen.js
 *
 * This file was generated by Sencha Architect
 * http://www.sencha.com/products/architect/
 *
 * This file requires use of the Sencha Touch 2.4.x library, under independent license.
 * License of Sencha Architect does not include license for Sencha Touch 2.4.x. For more
 * details see http://www.sencha.com/license or contact license@sencha.com.
 *
 * This file will be auto-generated each and everytime you save your project.
 *
 * Do NOT hand edit this file.
 */

Ext.define('ProDooMobileApp.view.StartScreen', {
    extend: 'Ext.carousel.Carousel',
    alias: 'widget.StartScreen',

    requires: [
        'Ext.Container',
        'Ext.Label',
        'Ext.Button',
        'Ext.Img'
    ],

    config: {
        cls: 'darkPurple',
        itemId: 'StartScreen',
        indicator: false,
        items: [
            {
                xtype: 'container',
                cls: 'UserInfo',
                docked: 'bottom',
                items: [
                    {
                        xtype: 'container',
                        cls: 'MenuIcon',
                        height: 48,
                        itemId: 'mycontainer29',
                        listeners: [
                            {
                                fn: function(component, eOpts) {
                                    component.element.on('tap',function(){
                                        if(this.hasCls('displayInfo')){
                                            G.hide('loggedUser');
                                            G.hide('Logout');
                                            G.hide('StartUserMode');
                                        }
                                        else{
                                            G.show('loggedUser');
                                            G.show('Logout');
                                            G.show('StartUserMode');
                                        }
                                        this.toggleCls('displayInfo');
                                    });
                                },
                                event: 'initialize'
                            }
                        ]
                    },
                    {
                        xtype: 'label',
                        cls: 'logLabel',
                        hidden: true,
                        html: ' ',
                        itemId: 'loggedUser'
                    },
                    {
                        xtype: 'container',
                        cls: 'clearfix',
                        hidden: true,
                        itemId: 'StartUserMode',
                        items: [
                            {
                                xtype: 'button',
                                cls: [
                                    'left',
                                    'UserModeBtn'
                                ],
                                itemId: 'StartCompanyBtn',
                                width: '50%',
                                text: 'Company'
                            },
                            {
                                xtype: 'button',
                                cls: [
                                    'left',
                                    'UserModeBtn'
                                ],
                                itemId: 'StartFreelancerBtn',
                                width: '50%',
                                text: 'Freelancer'
                            }
                        ]
                    },
                    {
                        xtype: 'button',
                        cls: 'logoutBtn',
                        hidden: true,
                        html: 'LOGOUT',
                        itemId: 'Logout'
                    }
                ]
            },
            {
                xtype: 'container',
                docked: 'top',
                hidden: true,
                itemId: 'StartHiddenItems',
                items: [
                    {
                        xtype: 'container',
                        itemId: 'StartSearchContainer',
                        items: [
                            {
                                xtype: 'container',
                                cls: [
                                    'topHeading',
                                    'green'
                                ],
                                docked: 'top',
                                html: 'Search'
                            },
                            {
                                xtype: 'container',
                                centered: true,
                                cls: 'imgTitle',
                                html: 'Discover what you need',
                                padding: '0 20',
                                items: [
                                    {
                                        xtype: 'image',
                                        height: 200,
                                        itemId: 'SearchContainerImg',
                                        margin: 'auto',
                                        width: 220,
                                        src: 'resources/images/searchIcon.png'
                                    }
                                ],
                                listeners: [
                                    {
                                        fn: function(element, eOpts) {
                                            element.on('tap',function(){
                                                Ext.ComponentQuery.query("#SearchContainerImg")[0].fireEvent('tap');
                                            });
                                        },
                                        event: 'painted'
                                    }
                                ]
                            }
                        ]
                    },
                    {
                        xtype: 'container',
                        itemId: 'StartResumeContainer',
                        items: [
                            {
                                xtype: 'container',
                                cls: [
                                    'topHeading',
                                    'blue2'
                                ],
                                docked: 'top',
                                html: 'Resume'
                            },
                            {
                                xtype: 'container',
                                centered: true,
                                cls: 'imgTitle',
                                html: 'write it down and become the chosen one',
                                itemId: 'StartResumeContainer',
                                padding: '0 20',
                                items: [
                                    {
                                        xtype: 'image',
                                        height: 200,
                                        itemId: 'ResumeContainerImg',
                                        margin: 'auto',
                                        width: 220,
                                        src: 'resources/images/resumeIcon.png'
                                    }
                                ],
                                listeners: [
                                    {
                                        fn: function(element, eOpts) {
                                            element.on('tap',function(){
                                                SearchResume.resetStores();
                                                ActiveScreen=0;
                                                UserResume.onResumeClick();
                                                //Ext.ComponentQuery.query("#ResumeContainerImg")[0].fireEvent('tap');
                                            });
                                        },
                                        event: 'painted'
                                    }
                                ]
                            }
                        ]
                    },
                    {
                        xtype: 'container',
                        itemId: 'StartRequestContainer',
                        items: [
                            {
                                xtype: 'container',
                                cls: [
                                    'topHeading',
                                    'green2'
                                ],
                                docked: 'top',
                                html: 'Request'
                            },
                            {
                                xtype: 'container',
                                centered: true,
                                cls: 'imgTitle',
                                html: 'see how much people intrested in your company',
                                itemId: 'mycontainer10',
                                padding: '0 20',
                                items: [
                                    {
                                        xtype: 'image',
                                        height: 183,
                                        itemId: 'RequestContainerImg',
                                        margin: 'auto',
                                        width: 160,
                                        src: 'resources/images/requestIcon.png'
                                    }
                                ],
                                listeners: [
                                    {
                                        fn: function(element, eOpts) {
                                            element.on('tap',function(){
                                                //      SearchResume.resetStores();
                                                //     ActiveScreen=1;
                                                // UserResume.onResumeClick();
                                                // G.get("RequestContainerImg").fireEvent('tap');
                                            });
                                        },
                                        event: 'painted'
                                    }
                                ]
                            }
                        ]
                    },
                    {
                        xtype: 'container',
                        itemId: 'StartMessageContainer',
                        items: [
                            {
                                xtype: 'container',
                                cls: [
                                    'topHeading',
                                    'orange'
                                ],
                                docked: 'top',
                                html: 'Message'
                            },
                            {
                                xtype: 'container',
                                centered: true,
                                cls: 'imgTitle',
                                html: 'Keep your contact with them',
                                itemId: 'mycontainer10',
                                padding: '0 20',
                                items: [
                                    {
                                        xtype: 'image',
                                        height: 156,
                                        itemId: 'MessageContainerImg',
                                        margin: 'auto',
                                        width: 220,
                                        src: 'resources/images/messageIcon.png'
                                    }
                                ],
                                listeners: [
                                    {
                                        fn: function(element, eOpts) {
                                            element.on('tap',function(){
                                                //     ActiveScreen=2;
                                                //     G.ShowView('MsgInbox');
                                                //     var store=Ext.getStore("MessageStore");
                                                //     store.clearFilter();
                                                //     store.load({
                                                //         params:{isInbox: true}
                                                //     });
                                                //     G.get("MessageSearchField").reset();
                                                Ext.ComponentQuery.query("#MessageContainerImg")[0].fireEvent('tap');
                                            });
                                        },
                                        event: 'painted'
                                    }
                                ]
                            }
                        ]
                    },
                    {
                        xtype: 'container',
                        itemId: 'StartPresentContainer',
                        items: [
                            {
                                xtype: 'container',
                                cls: [
                                    'topHeading',
                                    'red'
                                ],
                                docked: 'top',
                                html: 'Present'
                            },
                            {
                                xtype: 'container',
                                centered: true,
                                cls: 'imgTitle',
                                html: 'Make them love your pro',
                                itemId: 'mycontainer10',
                                padding: '0 20',
                                items: [
                                    {
                                        xtype: 'image',
                                        height: 190,
                                        itemId: 'PresentContainerImg',
                                        margin: 'auto',
                                        width: 220,
                                        src: 'resources/images/profileIcon.png'
                                    }
                                ],
                                listeners: [
                                    {
                                        fn: function(element, eOpts) {
                                            element.on('tap',function(){
                                                //     ActiveScreen=3;
                                                //     var loggedUserId = Ext.getStore('AuthStore').getAt(0).get('UserId');
                                                //     Ext.getStore('UserDetail').load({
                                                //             params : { userId : loggedUserId
                                                //             }
                                                //         });
                                                //     G.ShowView('PresentDetail');
                                                Ext.ComponentQuery.query("#PresentContainerImg")[0].fireEvent('tap');
                                            });
                                        },
                                        event: 'painted'
                                    }
                                ]
                            }
                        ]
                    },
                    {
                        xtype: 'container',
                        itemId: 'StartCompanyContainer',
                        items: [
                            {
                                xtype: 'container',
                                cls: [
                                    'topHeading',
                                    'orange2'
                                ],
                                docked: 'top',
                                html: 'Company'
                            },
                            {
                                xtype: 'container',
                                centered: true,
                                cls: 'imgTitle',
                                html: 'Your company tell them your ability',
                                itemId: 'mycontainer10',
                                padding: '0 20',
                                items: [
                                    {
                                        xtype: 'image',
                                        height: 160,
                                        itemId: 'CompanyContainerImg',
                                        margin: 'auto',
                                        width: 220,
                                        src: 'resources/images/companyIcon.png'
                                    }
                                ],
                                listeners: [
                                    {
                                        fn: function(element, eOpts) {
                                            element.on('tap',function(){
                                                //     if(Ext.getStore('AuthStore').getAt(0).get('IsFreelancer'))
                                                //         ActiveScreen=3;
                                                //     else
                                                //         ActiveScreen=4;
                                                //     var loggedUserId = Ext.getStore('AuthStore').getAt(0).get('UserId');
                                                //     var companyStore = Ext.getStore('CompanyDetail');
                                                //     companyStore.clearData();
                                                //     companyStore.load({
                                                //         params : { userId : loggedUserId
                                                //                  }
                                                //     });
                                                //     G.ShowView('CompanyDetail');
                                                Ext.ComponentQuery.query("#CompanyContainerImg")[0].fireEvent('tap');

                                            });
                                        },
                                        event: 'painted'
                                    }
                                ]
                            }
                        ]
                    },
                    {
                        xtype: 'container',
                        itemId: 'StartStatisticsContainer',
                        items: [
                            {
                                xtype: 'container',
                                cls: [
                                    'topHeading',
                                    'bluePurple'
                                ],
                                docked: 'top',
                                html: 'Statistics'
                            },
                            {
                                xtype: 'container',
                                centered: true,
                                cls: 'imgTitle',
                                html: 'Let us see how its going',
                                itemId: 'mycontainer10',
                                padding: '0 20',
                                items: [
                                    {
                                        xtype: 'image',
                                        height: 200,
                                        itemId: 'StatisticsContainerImg',
                                        margin: 'auto',
                                        width: 220,
                                        src: 'resources/images/statisticsIcon.png'
                                    }
                                ],
                                listeners: [
                                    {
                                        fn: function(element, eOpts) {
                                            element.on('tap',function(){
                                                //     ActiveScreen=5;
                                                //     Statistics.GetStatistics();
                                                Ext.ComponentQuery.query("#StatisticsContainerImg")[0].fireEvent('tap');
                                            });
                                        },
                                        event: 'painted'
                                    }
                                ]
                            }
                        ]
                    },
                    {
                        xtype: 'container',
                        itemId: 'StartSettingContainer',
                        items: [
                            {
                                xtype: 'container',
                                cls: [
                                    'topHeading',
                                    'lightPurple'
                                ],
                                docked: 'top',
                                html: 'Setting'
                            },
                            {
                                xtype: 'container',
                                centered: true,
                                cls: 'imgTitle',
                                html: 'Set it and love it',
                                itemId: 'mycontainer10',
                                padding: '0 20',
                                items: [
                                    {
                                        xtype: 'image',
                                        height: 208,
                                        itemId: 'SettingsContainerImg',
                                        margin: 'auto',
                                        width: 220,
                                        src: 'resources/images/settingIcon.png'
                                    }
                                ],
                                listeners: [
                                    {
                                        fn: function(element, eOpts) {
                                            element.on('tap',function(){
                                                //     ActiveScreen=6;
                                                //     G.ShowView('Setting');
                                                Ext.ComponentQuery.query("#SettingsContainerImg")[0].fireEvent('tap');
                                            });
                                        },
                                        event: 'painted'
                                    }
                                ]
                            }
                        ]
                    }
                ]
            },
            {
                xtype: 'image',
                height: 26,
                itemId: 'leftArrow',
                left: 10,
                top: '50%',
                width: 21,
                zIndex: 1,
                src: 'resources/images/lefticon.png'
            },
            {
                xtype: 'image',
                height: 26,
                itemId: 'rightArrow',
                right: 10,
                top: '50%',
                width: 21,
                zIndex: 1,
                src: 'resources/images/righticon.png'
            }
        ],
        listeners: [
            {
                fn: 'onStartCompanyBtnTap',
                event: 'tap',
                delegate: '#StartCompanyBtn'
            },
            {
                fn: 'onStartFreelancerBtnTap',
                event: 'tap',
                delegate: '#StartFreelancerBtn'
            },
            {
                fn: 'onLogoutTap',
                event: 'tap',
                delegate: '#Logout'
            },
            {
                fn: 'onSearchContainerImgTap',
                event: 'tap',
                delegate: '#SearchContainerImg'
            },
            {
                fn: 'onMyimgTap2',
                event: 'tap',
                delegate: '#ResumeContainerImg'
            },
            {
                fn: 'onMyimgTap21',
                event: 'tap',
                delegate: '#RequestContainerImg'
            },
            {
                fn: 'onMyimgTap',
                event: 'tap',
                delegate: '#MessageContainerImg'
            },
            {
                fn: 'onPresentContainerImgTap1',
                event: 'tap',
                delegate: '#PresentContainerImg'
            },
            {
                fn: 'onCompanyContainerImgTap',
                event: 'tap',
                delegate: '#CompanyContainerImg'
            },
            {
                fn: 'onMyimgTap1',
                event: 'tap',
                delegate: '#StatisticsContainerImg'
            },
            {
                fn: 'onMyimgTap3',
                event: 'tap',
                delegate: '#SettingsContainerImg'
            },
            {
                fn: 'onLeftArrowTap',
                event: 'tap',
                delegate: '#leftArrow'
            },
            {
                fn: 'onRightArrowTap',
                event: 'tap',
                delegate: '#rightArrow'
            },
            {
                fn: 'onCarouselActiveItemChange',
                event: 'activeitemchange'
            }
        ]
    },

    onStartCompanyBtnTap: function(button, e, eOpts) {
        SearchResume.ChangeUserMode(false);
    },

    onStartFreelancerBtnTap: function(button, e, eOpts) {
        SearchResume.ChangeUserMode(true);
    },

    onLogoutTap: function(button, e, eOpts) {

    },

    onSearchContainerImgTap: function(image, e, eOpts) {
        SearchResume.resetStores();
        G.ShowView('SearchResult');
        ActiveScreen=0;
    },

    onMyimgTap2: function(image, e, eOpts) {
        //SearchResume.resetStores();
        //ActiveScreen=0;
        //UserResume.onResumeClick();
    },

    onMyimgTap21: function(image, e, eOpts) {
        ActiveScreen=2;
        // G.ShowView('RequestScreen');
        Requests.ShowRequestView(true,true);
    },

    onMyimgTap: function(image, e, eOpts) {
        ActiveScreen=1;
        G.ShowView('MsgInbox');
        var store=Ext.getStore("MessageStore");
        store.clearFilter();
        store.load({
            params:{isInbox: true}
        });
        G.get("MessageSearchField").reset();

        if(Ext.getStore('AuthStore').getAt(0).data.IsFreelancer)
            Requests.ShowRequestView();
    },

    onPresentContainerImgTap1: function(image, e, eOpts) {
        SocialMediaList=new Array();
        Ext.getStore("SocialMediaStore").load(function(){
            this.data.items.forEach(function(item,index){
                SocialMediaList.push(item.data);
            });
        });

            ActiveScreen=2;


        var loggedUserId = Ext.getStore('AuthStore').getAt(0).get('UserId');
        Ext.getStore('UserDetail').load({
            params : { userId : loggedUserId
                     }
        });
        G.ShowView('PresentDetail');
    },

    onCompanyContainerImgTap: function(image, e, eOpts) {

            ActiveScreen=3;
        var loggedUserId = Ext.getStore('AuthStore').getAt(0).get('UserId');
        var companyStore = Ext.getStore('CompanyDetail');
        companyStore.clearData();
        companyStore.load({
            params : { userId : loggedUserId
                     }
        });
        G.ShowView('CompanyDetail');
    },

    onMyimgTap1: function(image, e, eOpts) {
        if(Ext.getStore('AuthStore').getAt(0).get('IsFreelancer'))
            ActiveScreen=3;
        else
            ActiveScreen=4;
        Statistics.GetStatistics();
    },

    onMyimgTap3: function(image, e, eOpts) {
        if(Ext.getStore('AuthStore').getAt(0).get('IsFreelancer'))
            ActiveScreen=4;
        else
            ActiveScreen=5;
        G.ShowView('Setting');
    },

    onLeftArrowTap: function(image, e, eOpts) {
        var carousel=Ext.ComponentQuery.query('carousel')[0];
        var iterator=5;
        if(Ext.getStore('AuthStore').getAt(0).get('IsFreelancer'))
            iterator=4;

        if(carousel.activeIndex === 0){//first item active
            for(var i=1; i<= iterator; i++){
                carousel.next();
            }
        }
        else {
            carousel.previous();
        }
    },

    onRightArrowTap: function(image, e, eOpts) {
        var carousel=Ext.ComponentQuery.query('carousel')[0];
        var iterator=5;
        if(Ext.getStore('AuthStore').getAt(0).get('IsFreelancer'))
            iterator=4;
        if(carousel.activeIndex == iterator){//last item active
            for(var i=1; i<= iterator; i++){
                carousel.previous();
            }
        }
        else{
            carousel.next();
        }
    },

    onCarouselActiveItemChange: function(container, value, oldValue, eOpts) {
        var carousel=Ext.ComponentQuery.query('carousel')[0];

        if((carousel.activeIndex===0)){
            //this.down('#leftArrow').hide();
        }
        else if(carousel.activeIndex === carousel.items.items.length-4){
            //this.down('#rightArrow').hide();
        }
        else{
            //     this.down('#leftArrow').show();
            //     this.down('#rightArrow').show();
        }
    },

    initialize: function() {
        this.callParent();
        this.addItems();
    },

    addItems: function() {
        var userRecord=Ext.getStore('AuthStore').getAt(0);
        var CaresolItems = [];

        /*Default views in their order
            'StartSearchContainer',
            'StartResumeContainer',
            'StartRequestContainer',
            'StartMessageContainer',
            'StartPresentContainer',
            'StartCompanyContainer',
            'StartStatisticsContainer',
            'StartSettingContainer'
            */

           G.setLoggedUsername(userRecord.get('FirstName'));


        if(userRecord.get('IsFreelancer')){
                CaresolItems = ['StartResumeContainer',
                                'StartMessageContainer',
                                'StartPresentContainer',
                                'StartStatisticsContainer',
                                'StartSettingContainer'];
                G.get('StartFreelancerBtn').addCls('ActiveBtn');
            }
            else{

                CaresolItems = ['StartSearchContainer',
                                'StartMessageContainer',
                                'StartRequestContainer',
                                'StartCompanyContainer',
                                'StartStatisticsContainer',
                                'StartSettingContainer'];
                G.get('StartCompanyBtn').addCls('ActiveBtn');
            }

            var View = G.get('StartScreen');
            var items = G.get('StartHiddenItems').items.items;
            var l= items.length;

            for(var i=0;i<CaresolItems.length;i++){
                View.add(G.get(CaresolItems[i]));
            }
    }

});